<!--
 Slide pour se pr√©senter

Story telling -> C'est quoi l'int√©gration et comment tu es arriv√© √† √ßa
Boss pour client le client doit int√©gr√© beaucoup de donn√©e mais c'est quoi l'int√©

Pr√©senter l'exemple

5 minutes de quesiton ou 0 min de question c'est ok

# Spring Boot 4.0.0 GA

## Ce qui change vraiment pour toi

_par Florian Lemaire & William Leemans_


Bonjour √† toutes et tous, nous allons maintenant vous parler de Spring Boot 4.0.0 GA et surtout de comment cette version va vous impacter dans votre travail de tous les jours.
On va se concentrer sur l'essentiel mais vous fournir en fin de talk des resources pour pouvoir explorer toutes les nouveaut√©s

---

## layout: center

# No√´l avant l'heure ! üéÑ


StoryTelling

Florian et moi √ßa fait plus de 10 ans qu'on fait du Spring, on l'a connu quand "Spring Boot" n'existait pas encore , on en a √©crit du XML (mais j'imagine que √ßa ne parle pas aux plus jeunes d'entre vous).

Aujourd'hui c'est un peu No√´l avant l'heure pour nous avec cette nouvelle version majeure de notre framework pr√©f√©r√©.

Alors commen√ßons sans plus tarder avec une petite note sur la base: Java !


---

## layout: center

# Baseline Java

---

## layout: split

::left::

<span class="chapter">Baseline Java</span>

## Quelle version utiliser ?

<div class="flex flex-col gap-6 mt-8">
    <div v-click class="pane glass-panel">
      <div class="flex items-center gap-3">
        <div>
          <div class="text-xl font-bold">Java 17</div>
          <div class="text-sm opacity-70">Version minimale</div>
        </div>
      </div>
    </div>
    <div v-click class="pane-green glass-panel">
      <div class="flex items-center gap-3">
        <div>
          <div class="text-xl font-bold">Java 25</div>
          <div class="text-sm opacity-70">Version recommand√©e</div>
        </div>
      </div>
  </div>
</div>

::right::

<div v-click="3" class="mt-16 ml-8">

### Pourquoi Java 25 ?

<div class="flex flex-col gap-3 mt-6">
  <div v-click="4" class="flex items-start gap-2">
    <div>
      <div class="font-semibold">Virtual Threads optimis√©s</div>
      <div class="text-sm opacity-70">Performance maximale</div>
    </div>
  </div>

  <div v-click="5" class="flex items-start gap-2">
    <div>
      <div class="font-semibold">Support jusqu'en 2030</div>
      <div class="text-sm opacity-70">5 ans de tranquillit√©</div>
    </div>
  </div>

  <div v-click="6" class="flex items-start gap-2">
    <div>
      <div class="font-semibold">Derni√®res am√©liorations</div>
      <div class="text-sm opacity-70">JEP 491, 506, 519...</div>
    </div>
  </div>
</div>

</div>


Tout comme la version 3.5.X, la version minimale requise de Java est la 17.

Mais la team Spring Boot recommande de passer directement √† la 25 pour profiter d'un maximum d'am√©liorations.

    Java 8 : mars 2022
    Java 11 : septembre 2023
    Java 17 : septembre 2026
    Java 21 : septembre 2028
    Java 25 : septembre 2030

Avec Java 25, vous profitez des Virtual Threads optimis√©s, d'un support jusqu'en 2030, et de toutes les derni√®res am√©liorations de la plateforme.

Si vous avez encore besoin de convaincre votre boss pour ne pas rester en Java 11 (ou pire, en Java 8 ?!), on va voir juste apr√®s ce que √ßa apporte concr√®tement.


---

## transition: view-transition

<span class="chapter">Baseline Java</span>

## Virtual Threads ( JEP 444 )

Gros gains de performance !

```yml
spring:
  threads:
    virtual:
      enabled: true
```

<p v-click>R√©solution des probl√®mes Java 21 + Spring Boot 3.5.X :</p>

<div class="flex flex-col gap-4 mt-6 w-2/5">
    <span v-click class="glass-panel pane text-md py-2 px-4">Thread pinning ( JEP 491 )</span>
    <span v-click class="glass-panel pane text-md py-2 px-4">Shutdown brutal</span>
    <span v-click class="glass-panel pane text-md py-2 px-4">Scoped Values ( JEP 506 )</span>
</div>

<img style="position: absolute; right: 40px; bottom: 40px"
v-click width="250" src="/images/pousse.gif"/>


Les Virtual Threads (JEP 444)

- Je vous ai mis les num√©ros des JEP sur la slide, avec √ßa vous pouvez facilement trouver plus d'infos sur internet, la documentation fournie par openjdk est tr√®s bien mais en anglais √©videmment

Premier gros argument pour passer sur la JDK 25, ce sont les virtual threads, on ne les pr√©sentes plus !

Faisant partie du projet Loom, √ßa va booster votre application sans n√©cessiter une r√©√©criture de votre app en r√©actif avec Spring Webflux.

C'est tr√®s facile d'activer cette feature dans Spring, il suffit de passer la property suivante a "true".

Ils ont pu grandement stabiliser leur utilisation dans Java 25 car m√™me si dispo depuis Java 21, il y avait encore pas mal de soucis, notamment de thread pinning (fix√© en JEP 491) , des soucis au niveau du shutdown et l'arriv√©e des Scoped Values (JEP 506 )


---

<span class="chapter">Baseline Java</span>

## Compact Object Headers ( JEP 519 )

<div class="glass-panel pane my-6"> R√©duction de 20% de l'empreinte m√©moire </div>

<p v-click>Id√©al pour microservices: </p>

<div class="grid grid-cols-5 grid-rows-2 gap-2">
    <span v-after class="glass-panel pane text-md py-2 px-4 col-span-2">Moins de GC</span>
    <span v-click class="text-4xl text-center m-auto py-2 px-4 text-orange/80">‚Üí</span>
    <span v-after class="glass-panel pane-green text-md py-2 px-4 col-span-2">Plus de performances</span>
    <span v-click class="glass-panel pane text-md py-2 px-4 col-span-2">Besoin de moins de m√©moire</span>
    <span v-click class="text-4xl text-center m-auto py-2 px-4 text-orange/80">‚Üí</span>
    <span v-after class="glass-panel pane-green text-md py-2 px-4 col-span-2">Plus d'√©conomies</span>
</div>

<img style="position: absolute; right: 350px; bottom: 10px"
v-click width="250" src="/images/stonk.png"/>


La JEP 519 c'est la premier feature int√©gr√©e du Projet Lilliput, qui est l'initiative d'OpenJDK pour r√©duire la taille des en-t√™tes d'objets Java de 128 bits (16 bytes) √† 64 bits (8 bytes) pour √©conomiser jusqu'√† 20% de m√©moire.

En Java 25 c'est activ√© par d√©faut, rien √† configurer.

Ca a de gros avantages surtout quand on fait des microservices.

Moins de m√©moire utilis√©e √ßa veut dire moins de GC et donc l'application java passe plus de temps process les requ√™tes ce qui augmente les perfs.

Et enfin qui dit moins de m√©moire n√©cessaire, dit √©conomies !


---

## layout: center

# Spring Boot 4.0.0 GA

---

layout: cover
transition: slide-up

---

<QuiVeutDesCadeaux title="1er cadeau !"/>

---

## layout: center

# La modularit√©


Spring boot 1.0

Spring-boot-autoconfigure jar weighing in at 182 KiB

Spring Boot 3.5 -> 2MiB (11x)

Disk space cheap mais la plupart des classes pas interessantes, auto-complete suggestion et config properties par pertinent -> Charge Mentale et confusion.


---

<span class="chapter">Modularit√©</span>

## Probl√®me : Config monolitique

<div class="grid grid-cols-3 gap-3 pt-4">
  <div class="pane glass-panel font-bold relative col-span-2">
    spring-boot-autoconfigure
    <span v-click.hide class="text-xs absolute right-2 bottom-2">182 kiB</span>
    <span v-click class="text-md absolute right-2 bottom-2 animate-pulse">2 MiB</span>
  </div>
</div>

<div v-click class="my-4">Cons√©quences :</div>

<div class="grid grid-cols-2 grid-rows-2 gap-2">
    <span v-after class="glass-panel pane-red text-md py-2 px-4">Classes inutiles dans le classpath</span>
    <span v-click class="glass-panel pane-red text-md py-2 px-4">Auto-compl√©tion IDE surcharg√©e</span>
    <span v-click class="glass-panel pane-red text-md py-2 px-4">Confusion et charge mentale accrue</span>
    <span v-click class="glass-panel pane-red text-md py-2 px-4">Co√ªts de scan au d√©marrage √©lev√©s</span>
</div>


√âvolution du JAR spring-boot-autoconfigure

Spring Boot 1.0 (2014) : 182 KiB
Spring Boot 3.5 : 2 MiB (√ó10 en taille !)

Cons√©quences

‚ùå Classes inutiles dans le classpath
‚ùå Auto-compl√©tion IDE surcharg√©e
‚ùå Suggestions de propri√©t√©s non pertinentes
‚ùå Confusion et charge mentale accrue
‚ùå Co√ªts de scan au d√©marrage √©lev√©s


---

<span class="chapter">Modularit√©</span>

## Solution : Modules cibl√©s

<span>Au lieu d'un JAR monolithique ‚Üí modules petits et focalis√©s</span>

<div class="grid grid-cols-3 gap-3">
  <div v-click class="pane glass-panel">
    spring-boot-data-jdbc
  </div>

  <div v-click class="pane glass-panel">
    spring-boot-starter-webmvc
  </div>

  <div v-click class="pane glass-panel">
    spring-boot-starter-flyway
  </div>
</div>

<div v-click class="my-4">Avantages :</div>

<div class="grid grid-cols-2 grid-rows-2 gap-3 pt-2">
    <span v-after class="glass-panel pane-green py-2 px-4">Maintenabilit√©</span>
    <span v-click class="glass-panel pane-green py-2 px-4">Taille r√©duite</span>
    <span v-click class="glass-panel pane-green py-2 px-4">Signal fort </span>
    <span v-click class="glass-panel pane-green py-2 px-4">Nouveaux cas d'usage</span>
</div>


Spring boot 1.0

Spring-boot-autoconfigure jar weighing in at 182 KiB

Spring Boot 3.5 -> 2MiB (11x)

Disk space cheap mais la plupart des classes pas interessantes, auto-complete suggestion et config properties par pertinent -> Charge Mentale et confusion.


---

<span class="chapter">Modularit√©</span>

## Solution : Modules cibl√©s

<div class="py-2"></div>

````md magic-move
```xml {all|1-4|5-8|9-12|all}
<dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-web</artifactId>
</dependency>
<dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-security</artifactId>
</dependency>
<dependency>
  <groupId>org.flywaydb</groupId>
  <artifactId>flyway-core</artifactId>
</dependency>
```

```xml {all|9-12|1-4||all}
<dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-webmvc</artifactId>
</dependency>
<dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-security</artifactId>
</dependency>
<dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-flyway</artifactId>
</dependency>
```
````

<div v-click class="pane glass-panel mt-6">
    Une liste exhaustive des starters est disponible dans le guide de migration.
</div>

---

<span class="chapter">Modularit√©</span>

## Un impact aussi sur les Test !

<div class="grid grid-cols-3 gap-3 py-2">
  <div class="pane glass-panel font-bold relative col-span-2">
    spring-boot-test-autoconfigure
  </div>
</div>

```xml {all|3,8,13|all}

<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-webmvc-test</artifactId>
    <scope>test</scope>
</dependency>
<dependency>
<groupId>or g.springframework.boot</groupId>
<artifactId>spring-boot-starter-security-test</artifactId>
<scope>test</scope>
</dependency>
<dependency>
<groupId>org.springframework.boot</groupId>
<artifactId>spring-boot-starter-flyway-test</artifactId>
<scope>test</scope>
</dependency>
```

---

<span class="chapter">Modularit√©</span>

## Les "classic starters"

Si vous n'avez pas le temps :

```xml

<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-classic</artifactId>
</dependency>
<dependency>
<groupId>org.springframework.boot</groupId>
<artifactId>spring-boot-starter-test-classic</artifactId>
<scope>test</scope>
</dependency>
```

---

layout: cover
transition: slide-up

---

<QuiVeutDesCadeaux title="2√®me Cadeau !"/>

---

## layout: center

# Les Http Service Clients

## Un client Spring Native !

---

<span class="chapter">Http Service Client</span>

## Le probl√®me historique

üêå RestTemplate ‚Üí d√©pr√©ci√©
üí° WebClient ‚Üí r√©actif mais pas naturel pour du REST bloquant
‚öôÔ∏è Clients vari√©s (Feign, OkHttp, etc.)

## Http Service Clients

Spring r√©introduit un support **d√©claratif d‚Äôinterfaces HTTP**
=> Gr√¢ce √† des interfaces Java et √† un proxy g√©n√©r√© automatiquement.


Les clients HTTP ont souvent √©volu√© cot√© Spring.
On voit encore des Rest Template d√©pr√©ci√©s dans nos projets, faute de nos projets.
Ensuite on devait passer sur WebClient qui venait du R√©actif et qui posait souvent des soucis.

Du coup beaucoup entre nous utilisaient des libs externes comme Feign, OkHttp, Retrofit etc...


---

<span class="chapter">Http Service Client</span>

## D√©finir un client HTTP d√©claratif

```java
@HttpExchange("/pokemon")
public interface PokemonClient {

  @GetExchange("/{name}")
  PokemonApiResponse getPokemon(@PathVariable String name);

}
```

‚úÖ Pas d‚Äôimpl√©mentation √† √©crire
‚úÖ Les conversions JSON sont automatiques
‚úÖ Int√©gration Spring Boot compl√®te ()

---

<span class="chapter">Http Service Client</span>

## Avec une config super simple

```yml
spring:
  http:
    serviceclient:
      pokemon:
        base-url: https://pokeapi.co/api/v2
        connect-timeout: 3s
        read-timeout: 5s
```

‚úî Auto-configur√©
‚úî Timeout g√©r√©
‚úî Base URL injectable
‚úî Tracing & m√©triques automatiques

---

<span class="chapter">Http Service Client</span>

## R√©unir les clients en groupe

Quand on a plusieurs clients HTTP diff√©rents, Spring organise √ßa avec des groupes.

```java
// En sp√©cifiant directement les classes
@ImportHttpServices(group = "pokemon", types = {PokemonClient.class, SpeciesClient.class})

// Ou le package de base
@ImportHttpServices(group = "pokemon", basePackages = "com.jetdev.demospringboot4.clients.pokemon")
```

Tous les clients d‚Äôun m√™me groupe partagent la m√™me config : base URL, timeouts, convertisseurs, etc.

Spring introduit un registry interne (HttpServiceProxyRegistry) qui g√®re les clients et leurs configurations.

‚úî Centralise la configuration
‚úî R√©duit la duplication
‚úî Pr√™t pour l‚ÄôAOT / Native builds


En utilisant les groupes, √ßa nous permet d'avoir une configuration pour plusieurs clients.
On n'a plus besoin d'une classe de config par client, on simplifie encore le code gr√¢ce √† Spring.

Pour finir ces clients et groupes sont Spring Native, et donc li√©s directement au starter opentelemetry par exemple,
ou d√©j√† configur√©s pour les builds en natif.


---

layout: cover
transition: slide-up

---

<QuiVeutDesCadeaux title="3√®me Cadeau !"/>


On attaque maintenant un sujet qui nous a tous fait souffrir au moins une fois :
le versioning d‚ÄôAPI.

AJOUTER v1, v2, v3 dans les URLs, maintenir plusieurs contr√¥leurs, casser des clients‚Ä¶
Bref : la joie.


---

## layout: center

# Le versioning d'API

## Enfin en standard dans Spring Boot 4


Jusqu‚Äô√† Spring Boot 3, le versioning √©tait soit :
- bricol√© avec des Headers custom
- fait dans l‚ÄôURL (/v1, /v2)
- ou g√©r√© c√¥t√© gateway

Spring Boot 4 introduit un vrai support officiel du versioning au niveau du mapping MVC.


---

<span class="chapter">Versioning d'API</span>

## Avant Spring Boot 4

```java
@GetMapping("/api/v1/pokemon/{name}")
public PokemonDto v1(...) {}

@GetMapping("/api/v2/pokemon/{name}")
public PokemonV2Dto v2(...) {}
```

‚ùå Duplication de routes
‚ùå Explosion du nombre de contr√¥leurs
‚ùå Tests plus complexes
‚ùå Difficile √† faire √©voluer proprement

---

<span class="chapter">Versioning d'API</span>

## Avec Spring Boot 4

```java
@GetMapping(value = "/{name}", version = "1.0")
public PokemonDto getPokemonV1(...) {}

@GetMapping(value = "/{name}", version = "1.2")
public PokemonWithSpeciesDto getPokemonV1_2(...) {}
```

‚úÖ M√™me URL
‚úÖ Plusieurs impl√©mentations
‚úÖ Routing automatique par version
‚úÖ Lisible et maintenable

---

<span class="chapter">Versioning d'API</span>

## Configuration

```yml
spring:
  mvc:
    apiversion:
      default: 1.0
      use:
        header: API-Version
        # query-parameter / path-segment / media-type-parameter
```


On passe la d√©mo, on parle de l'exact match et du base match, on montre le probl√®me avec la 1.3


---

layout: cover
transition: slide-up

---

<QuiVeutDesCadeaux title="4√®me Cadeau !"/>

---

## layout: center

# RestTestClient

## Le client HTTP de test moderne


RestTestClient remplace progressivement MockMvc/WebTestClient
pour tester les APIs HTTP dans Spring MVC.
Il apporte une API fluide, expressive et puissante.


---

<span class="chapter">RestTestClient</span>

## Avant RestTestClient

üçÇ MockMvc

- API verbeuse
- Sp√©cifique MVC
- Assertions complexes

üçÇ WebTestClient

- Orient√© WebFlux
- Pas naturel dans MVC

‚ùå Pas d‚Äôunification
‚ùå Pas de client HTTP unique


Si vous avez plusieurs clients diff√©rents dans votre app,
vous finissez avec plusieurs confs de test, √ßa devient vite le bordel


---

<span class="chapter">RestTestClient</span>

## Avec RestTestClient

üéØ Un **client HTTP de test unique**
üéØ API fluide inspir√©e de WebTestClient
üéØ Fonctionne avec :

- MockMvc
- RouterFunctions
- Serveur r√©el (HTTP)

üéØ Assertions int√©gr√©es faciles

---

<span class="chapter">RestTestClient</span>

## Comment l‚Äôutiliser ?

### 1. contre MockMvc

```java
RestTestClient client = RestTestClient
    .bindToController(myController)
    .build();
```

üëâ Teste le contr√¥leur sans serveur HTTP r√©el

### 2. contre un serveur r√©el

```java
RestTestClient client = RestTestClient
        .bindToServer()
        .baseUrl("http://localhost:8080")
        .build();
```

üëâ Appelle r√©ellement l‚ÄôAPI via HTTP

---

<span class="chapter">RestTestClient</span>

## Des assertions puissantes

```java
client.get()
  .uri("/api/foo")
  .exchange()
  .expectStatus().is4xxClientError()
  .expectHeader().contentType(MediaType.APPLICATION_JSON)
  .expectBody()
  .jsonPath("$.error").isEqualTo("NotFound");
```

‚úÖ Status
‚úÖ Headers
‚úÖ JSON body
‚úÖ JsonPath


puis pitite d√©mo


---

layout: cover
transition: slide-up

---

<QuiVeutDesCadeaux title="5√®me Cadeau !"/>

---

## layout: center

# La null safety

---

<span class="chapter">Null Safety</span>

## L'erreur √† un milliard de dollars

<div class="pane-red glass-panel mt-36 mb-12">
Exception in thread "main" java.lang.NullPointerException
</div>

<div v-click class="flex justify-end">
    <div class="text-xl opacity-70 italic max-w-2xl">
        "I call it my billion-dollar mistake..."
        <div class="mt-2">‚Äî Tony Hoare, 1965</div>
    </div>
</div>

---

<span class="chapter">Null Safety</span>

<img style="height: 60px" src="/images/jspecify-banner.svg" class="invert" />

<p v-click>Annotations :</p>

<div class="grid grid-cols-2 grid-rows-2 gap-3 pt-2">
    <span v-after class="glass-panel pane py-2 px-4">@NonNull</span>
    <span v-click class="glass-panel pane py-2 px-4">@Nullable</span>
    <span v-click class="glass-panel pane py-2 px-4">@NullMarked</span>
    <span v-click class="glass-panel pane py-2 px-4">@NullUnmarked</span>
</div>

---

<span class="chapter">Null Safety</span>

## Projets d√©j√† annot√©s

<div class="grid grid-cols-4 grid-rows-6 gap-2 pt-12">
    <span class="glass-panel pane py-2 text-xs px-4">Spring Boot 4.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Framework 7.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Data 4.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Security 7.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Batch 6.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Kafka 4.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Integration 7.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring GraphQL 2.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Web Services 5.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring AMQP 4.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Shell 4.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Kafka 4.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Plugin 4.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring HATEOAS 3.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Modulith 2.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Vault 4.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Cloud Commons 5.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Spring Cloud Gateway 5.0</span>
    <span class="glass-panel pane py-2 text-xs px-4">Micrometer 1.16</span>
    <span class="glass-panel pane py-2 text-xs px-4">Micrometer Tracing 1.6</span>
    <span class="glass-panel pane py-2 text-xs px-4">Context Propagation 1.2</span>
    <span class="glass-panel pane py-2 text-xs px-4">Reactor 2025.0</span>
</div>



Support Intellij Incroyable



---

<span class="chapter">Null Safety</span>

## JSpecify en action

Au niveau du package [`package-info.java`] :

```java
@NullMarked
package fr.jetdev;

import org.jspecify.annotations.NullMarked;
```

---

<span class="chapter">Null Safety</span>

## JSpecify en action

En action :

````md magic-move
```java
public class UserService {

    public User findById(Long id) {
        return repository.findById(id);
    }

    public void process(User user) {
        String name = user.getName();
        System.out.println(name.toUpperCase());
    }
}
```

```java {all|3|8|all}
import org.jspecify.annotations.Nullable;

public class UserService {

    public @Nullable User findById(Long id) {
        return repository.findById(id);
    }

    public void process(User user) {
        String name = user.getName();
        System.out.println(name.toUpperCase());
    }
}
```

```java {all|9-10|all}
import org.jspecify.annotations.Nullable;

public class UserService {

    public @Nullable User findById(Long id) {
        return repository.findById(id);
    }

    public void process(User user) {
        String name = user.getName();
        System.out.println(name.toUpperCase()); // ‚ö†Ô∏è Warning IDE !
        // Possible NullPointerException
    }
}
```

```java {all|9-13|all}
import org.jspecify.annotations.Nullable;

public class UserService {

    public @Nullable User findById(Long id) {
        return repository.findById(id);
    }

    public void process(@Nullable User user) {
        if (user != null) {
            String name = user.getName();
            System.out.println(name.toUpperCase()); // ‚úÖ Safe !
        }
    }
}
```
````

<div v-click="4" class="pane glass-panel pane-green mt-6 p-4">
  ‚ú® L'IDE vous pr√©vient <strong>avant</strong> l'ex√©cution !
</div>


Voyons comment JSpecify fonctionne en pratique.

D'abord on annote notre m√©thode avec @Nullable pour indiquer qu'elle peut retourner null.

Ensuite, l'IDE d√©tecte automatiquement qu'on utilise potentiellement une valeur null sans v√©rification.

Enfin, on ajoute la v√©rification n√©cessaire et l'IDE est content.

C'est du shift-left : on d√©tecte les bugs pendant le d√©veloppement, pas en production !


---

<span class="chapter">Null Safety</span>

## NullAway

Verification de la nullabilit√© au build-time.

<span class="glass-panel pane">JDK 21.0.8+</span>

ou

<span class="glass-panel pane">Java 25 Toolchain</span> + <span class="glass-panel pane">build avec --release 17.</span>

---

layout: cover
transition: slide-up

---

<QuiVeutDesCadeaux title="6√®me Cadeau !"/>


Sixi√®me gros cadeau de Spring Boot 4 :
l‚Äôobservabilit√© devient enfin simple, standard et unifi√©e.

Avant, entre Micrometer, Sleuth, Zipkin, Prometheus, Grafana, OTEL‚Ä¶
c‚Äô√©tait souvent un patchwork.


---

## layout: center

# L‚Äôobservabilit√©

## Enfin un standard par d√©faut


Spring Boot 4 adopte OpenTelemetry comme standard unique.
Plus besoin d‚Äôempiler plusieurs stacks.


---

<span class="chapter">Observabilit√©</span>

## Avant Spring Boot 4

### Le mille-feuille de l‚Äôobservabilit√©

- Micrometer pour les m√©triques
- Sleuth pour le tracing
- Zipkin / Jaeger pour la collecte
- Prometheus pour le scraping
- Grafana pour la visualisation

‚ùå Beaucoup de briques
‚ùå Beaucoup de configs
‚ùå Beaucoup d‚Äôincoh√©rences


Chaque projet avait son propre mix.
Et au final, les √©quipes perdaient beaucoup de temps
juste pour "avoir des m√©triques".


---

<span class="chapter">Observabilit√©</span>

## Avec Spring Boot 4

‚úÖ OpenTelemetry devient le **socle unique**
‚úÖ Traces + m√©triques + logs corr√©l√©s
‚úÖ Export standard OTLP
‚úÖ Compatible avec **Tous les backends**

- Grafana Tempo
- Prometheus
- Jaeger
- Datadog
- Dynatrace
- New Relic


OpenTelemetry n‚Äôest plus une option :
c‚Äôest la base officielle de Spring Boot 4.


---

<span class="chapter">Observabilit√©</span>

## Le nouveau starter

```xml

<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-opentelemetry</artifactId>
</dependency>
```

‚úÖ Une seule d√©pendance
‚úÖ Auto-configuration compl√®te
‚úÖ Plus besoin de Sleuth
‚úÖ Plus besoin de config Micrometer manuelle


On ajoute un seul starter,
et tout est branch√© automatiquement.


---

<span class="chapter">Observabilit√©</span>

## Configuration minimale

```yml
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
  tracing:
    sampling:
      probability: 1.0
  opentelemetry:
    tracing:
      export:
        otlp:
          endpoint: http://localhost:4318/v1/traces
  otlp:
    metrics:
      export:
        url: http://localhost:4318/v1/metrics
```

‚úÖ Traces activ√©es
‚úÖ M√©triques activ√©es
‚úÖ Export OTLP standard
‚úÖ Aucun code √† √©crire

---

<span class="chapter">Observabilit√©</span>

## Ce qui est instrument√© automatiquement

‚úÖ Requ√™tes HTTP serveur
‚úÖ Appels HTTP clients
‚úÖ Threading
‚úÖ Pools de connexions
‚úÖ JVM (CPU, m√©moire, GC)
‚úÖ Exceptions


Sans aucune annotation dans le code.
L‚Äôinstrumentation est enti√®rement automatique.


---

<span class="chapter">Observabilit√©</span>

## Tracing distribu√©

Chaque appel HTTP g√©n√®re :

‚úÖ Un trace-id
‚úÖ Des spans serveurs
‚úÖ Des spans clients
‚úÖ Une corr√©lation automatique

üëâ Visible dans :

- Grafana Tempo
- Jaeger
- Dynatrace


On peut suivre un appel :
du contr√¥leur
jusqu‚Äôau client externe
sans √©crire une seule ligne de code.


---

layout: cover
transition: slide-up

---

<QuiVeutDesCadeaux title="7√®me Cadeau !"/>

---

## layout: center

# La r√©silience

---

## layout: center

# Jackson 3.0

---

# Jackson 3.0 - Nouveaut√©s majeures

- **Java 17 minimum** requis (comme Spring Boot 4)
- **Nouveau package** : `tools.jackson` remplace `com.fasterxml.jackson`
- **Annotations unifi√©es** : plus besoin de `jackson-annotations` s√©par√©
- **Meilleure null-safety** et int√©gration avec JSpecify

---

# Jackson 3.0 - Performance & API

- **Streaming API am√©lior√©e** : parsing JSON encore plus rapide
- **Records Java** : support natif sans configuration
- **Immutables** : meilleur support des objets immuables
- **Builder pattern** : d√©tection automatique des builders

---

# Jackson 3.0 - Breaking Changes

Avant

```java
import com.fasterxml.jackson.databind.ObjectMapper;
```

Apr√®s

```java
import tools.jackson.databind.ObjectMapper
```

‚ö†Ô∏è Migration n√©cessaire des imports dans tout le code

---

# Jackson 3.0 - Nouvelles annotations

```java
// Support natif des records
public record Person(String name, int age) {}

// Constructeur avec @JsonCreator implicite
// Plus besoin d'annoter explicitement !

ObjectMapper mapper = new ObjectMapper();
Person p = mapper.readValue(json, Person.class);
```

---

# Jackson 3.0 - Configuration Spring Boot 4

```yaml
# application.yml - Auto-configur√© par Spring Boot 4
spring:
  jackson:
    default-property-inclusion: non_null
    serialization:
      indent_output: true
    deserialization:
      fail_on_unknown_properties: false
```

---

## layout: center

# Comment migrer ?

https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-4.0-Migration-Guide

---

# Les liens cools :

- [Null Safety en Java avec JSpecify et NullAway - S√©bastien Deleuze](https://www.youtube.com/watch?v=F_Qyo1cCpvY)

---

## layout: center

# Fin -->
